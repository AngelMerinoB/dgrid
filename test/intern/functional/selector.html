<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Test dgrid/selector module</title>

		<link rel="stylesheet" href="../../../css/dgrid.css">

		<style>
			.dgrid {
				height: 12em;
				margin-bottom: 3em;
			}

			.dgrid .field-select {
				width: 3em;
			}

			.dgrid .field-col1,
			.dgrid .field-col2,
			.dgrid .field-col5 {
				width: 8em;
			}

			.gridContainer {
				vertical-align: top;
				width: 500px;
			}
		</style>
	</head>

	<body class="claro">
		<table>
			<tr>
				<td class="gridContainer">
					<h3>Extended selectionMode</h3>
					<div id="gridExtended"></div>

					<h3>Multiple selectionMode</h3>
					<div id="gridMultiple"></div>

					<h3>Single selectionMode</h3>
					<div id="gridSingle"></div>
				</td>

				<td class="gridContainer">
					<h3>Toggle selectionMode</h3>
					<div id="gridToggle"></div>

					<h3>None selectionMode</h3>
					<div id="gridNone"></div>
				</td>
			</tr>
		</table>


		<script>
			var dojoConfig = {
				async: true,
				baseUrl: "../../../../",
				packages: [
					"dojo",
					"dijit",
					"dojox",
					"dgrid",
					"put-selector",
					"xstyle"
				],
			};
		</script>

		<script src="../../../../dojo/dojo.js"></script>

		<script>
			var gridExtended;
			var gridMultiple;
			var gridSingle;
			var gridToggle;
			var gridNone;
			var ready = false;

			require([
				"dojo/_base/declare",
				"dojo/_base/lang",
				"dgrid/OnDemandGrid",
				"dgrid/Selection",
				"dgrid/selector",
				"dgrid/test/data/base"
			], function (declare, lang, OnDemandGrid, Selection, selector, testStore) {
				var SelectionGrid = declare([OnDemandGrid, Selection]);

				var columns = {
					col1: "Column 1",
					col2: "Column 2",
					col5: "Column 5"
				};

				var selectorConfig = {
					label: "Select",
					disabled: function (rowData) {
						return rowData.id % 2;
					}
				};

				gridExtended = new SelectionGrid({
					store: testStore,
					columns: lang.delegate(columns, {
						select: selector(lang.clone(selectorConfig))
					}),
					selectionMode: "extended",
					allowSelectAll: true
				}, "gridExtended");

				gridMultiple = new SelectionGrid({
					store: testStore,
					columns: lang.delegate(columns, {
						select: selector(lang.clone(selectorConfig))
					}),
					selectionMode: "multiple",
					allowSelectAll: true
				}, "gridMultiple");

				gridSingle = new SelectionGrid({
					store: testStore,
					columns: lang.delegate(columns, {
						select: selector({
							label: "Select",
							selectorType: "radio",
							disabled: function (rowData) {
								return rowData.id % 2;
							}
						})
					}),
					selectionMode: "single",
					allowSelectAll: true
				}, "gridSingle");

				gridToggle = new SelectionGrid({
					store: testStore,
					columns: lang.delegate(columns, {
						select: selector(lang.clone(selectorConfig))
					}),
					selectionMode: "toggle",
					allowSelectAll: true
				}, "gridToggle");

				gridNone = new SelectionGrid({
					store: testStore,
					columns: lang.delegate(columns, {
						select: selector(lang.clone(selectorConfig))
					}),
					selectionMode: "none",
					allowSelectAll: true
				}, "gridNone");

				ready = true;
			});
		</script>

		<script>
		// Debugging code for troubleshooting WebDriver behavior.
		// In Chrome, with ChromeDriver, using the WebDriver API to send:
		// Shift (down)
		// Mouse click
		// Shift (up)
		// results in a shift+click.
		// In Firefox, with Selenium's built-in driver (Selenium server 2.39, Firefox 26.0, Windows 7 SP1),
		// the same sequence results in an un-shifted click (although the keydown and keyup for the shift
		// key are registered).

		(function () {
			// Comment out the following line to enable debug event listeners:
			return;

			var log = function (msg) {
				var node = document.createElement('p');
				node.innerHTML = msg;
				document.body.appendChild(node);
			}

			document.body.addEventListener('keydown', function (event) {
				log('keydown: ' + event.keyCode);
			});
			document.body.addEventListener('keyup', function (event) {
				log('keyup: ' + event.keyCode);
			});
			document.body.addEventListener('mousedown', function (event){
				log('mousedown' + (event.shiftKey ? '(shift)' : ''));
			});
			document.body.addEventListener('mouseup', function (event){
				log('mouseup' + (event.shiftKey ? '(shift)' : ''));
			});
			document.body.addEventListener('click', function (event) {
				log('click' + (event.shiftKey ? '(shift)' : ''));
			});
		}());
		</script>
	</body>
</html>
